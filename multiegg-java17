FROM ubuntu:latest

RUN apt-get install -y software-properties-common
RUN add-apt-repository ppa:ondrej/php

RUN apt-get update && apt-get install -y bash coreutils findutils curl binfmt-support cron wget git python3 nodejs unzip ca-certificates  libncursesw5
RUN apt-get update && \
    apt-get install -y curl nginx php8.0 php8.0-fpm php8.0-xml php8.0-exif php8.0-session php8.0-soap php8.0-openssl php8.0-gmp php8.0-pdo_odbc php8.0-json php8.0-dom php8.0-pdo php8.0-zip php8.0-mysqli php8.0-sqlite3 php8.0-pdo_pgsql php8.0-bcmath php8.0-gd php8.0-odbc php8.0-pdo_mysql php8.0-pdo_sqlite php8.0-gettext php8.0-xmlreader php8.0-bz2 php8.0-iconv php8.0-pdo_dblib php8.0-curl php8.0-ctype php8.0-phar php8.0-fileinfo php8.0-mbstring php8.0-tokenizer php8.0-simplexml && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* && \
    ln -s /usr/bin/php8.0 /usr/bin/php && \
    curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer


RUN mkdir ~/exagear
WORKDIR ~/exagear

RUN wget https://dl.insrt.uk/mirror/exagear/exagear-guest-ubuntu-1804_3428_all.deb
RUN wget https://dl.insrt.uk/mirror/exagear/exagear_3428-1_arm64.deb

RUN dpkg -i exagear*3428*.deb
RUN dpkg -i exagear-guest*.deb

RUN curl https://dl.insrt.uk/mirror/exagear/patch.sh | bash

RUN apt-get update && apt-get upgrade -y
RUN apt-get update && apt-get install -y wine

# OpenJDK 8 kurulumu
RUN apt-get update && apt-get install -y openjdk-17-jdk
RUN apt-get install jq -y
USER container
ENV  USER container
ENV HOME /home/container

WORKDIR /home/container
COPY ./entrypoint.sh /entrypoint.sh


CMD ["/bin/bash", "/entrypoint.sh"]
